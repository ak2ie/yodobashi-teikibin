!function(s){function i(){return"undefined"!=typeof communityNewReviewUrl&&"undefined"!=typeof communityPopularQuestionUrl&&(o=communityUserUrl,c=unsanitizeString(communityNewReviewUrl),l=unsanitizeString(communityPopularQuestionUrl),u=communityReviewListUrl,m=communityReviewDetailUrl,p=communityQuestionListUrl,v=communityQuestionSubmitUrl,d=communityQuestionDetailUrl,f=seoAjax,!0)}function a(){return wsUrl}function e(){return sku}function n(i){function a(s){return o.replace(/,USERNAME,/,s)}function e(s){var i=new Date(s);return i.getFullYear()+"年"+("0"+(i.getMonth()+1)).slice(-2)+"月"+("0"+i.getDate()).slice(-2)+"日"+("0"+i.getHours()).slice(-2)+":"+("0"+i.getMinutes()).slice(-2)}function n(s){f({url:c+"&_="+(new Date).getTime(),dataType:"json",success:function(i){s("community NewReview is success."),C=i},error:function(){s("community NewReview is error.")}})}function t(i,n){function t(i,a){var e='<div class="pdCommunityMainCol" id="js_pdCommunityMainCol"><div class="comEmphasis"><a href="<%= params.communityReviewListUrl %>"><span>レビュー</span></a><span class="num">（<%= data.totalCount %>）</span></div><div class="comWallBlock"><% _.each(data.reviews, function(review) { %><div class="comListUnit clearfix"><div class="userImg"><a class="js_userImg js_reviewUserUrlDst" href="<%= review.userUrl %>"><img src="<%= review.communityUser.profileImageUrl %>"></a></div><% if (review.topImageUrl) { %><div class="comLineInfo comRevieImg"><% } else { %><div class="comLineInfo"><% } %><div class="hznList"><% if (parseInt(review.productSatisfactionCode) >= 0 && parseInt(review.productSatisfactionCode) <= 5) { %><span class="valueAvg"><span class="iconStarM rate<%= review.productSatisfactionCode %>_0"></span></span><% } %><% if (review.reviewDecisivePurchases) { %><span class="bl1s03gr"><span class="fs11">購入の決め手：<%= review.reviewDecisivePurchases %></span></span><% } %></div><% if (review.topImageUrl) { %><div class="comLineRev clearfix"><a href="<%= review.reviewDetailUrl %>"><img src="<%= review.topImageUrl %>"></a></div><% } %><% if (review.reviewBody) { %><p class="cntrbtTxt mLeft60"><%= review.reviewBody %></p><% } %><p class="mLeft60"><a class="fs11 js_reviewDetailUrl" href="<%= review.reviewDetailUrl %>">詳しく見る</a></p><div class="comLineSocial mLeft60"><span class="uiIconTxtS"><i class="iconLiS icon15S"></i><span><%= review.likeCount %></span></span><span class="uiIconTxtS"><i class="iconLiS icon14S"></i><span><%= review.commentCount %></span></span><span class="fs11 gray"><%= review.postDate %></span></div><div class="comLineCredit mLeft60"><span><a href="<%= review.userUrl %>"><%= review.communityUser.communityName %></a>さん</span><span class="uiIconTxtS"><i class="iconLiS icon43S"></i><span><%= review.purchaseDateText %></span></span></div></div></div><% }) %></div><div class="fs13 mt30"><a href="<%= params.communityReviewListUrl %>">すべてのレビューを見る</a><span class="num">（<%= data.totalCount %>）</span></div></div>';var n=s.template(e);var t=n(a);i.append(t)}function r(s){var i;var a;var e="";if(null!==s&&void 0!==s&&0!==s.length)for(a=s.length,i=0;i<a;i++)0!==i&&(e+="、"),e+=s[i].decisivePurchaseName}function o(s){return m.replace(/,REVIEWID,/,s)}function c(s,i){return 1===i?s+"にヨドバシカメラで購入しました":s+"に購入しました"}var l={};var p=n.reviews;var v=p.length;var d,f;for(d=0;d<v;d++)f=p[d],f.productSatisfactionCode=Math.floor(f.productSatisfactionCode),f.reviewDecisivePurchases=r(f.reviewDecisivePurchases),f.reviewDetailUrl=o(f.reviewId),f.postDate=e(f.postDate),f.postDate=c(f.purchaseDateText,f.purchaseType),f.userUrl=a(f.communityUser.communityName);l.communityReviewListUrl=u,t(i,{data:n,params:l})}function r(s){f({url:l+"&_="+(new Date).getTime(),dataType:"json",success:function(i){s("community PopularQuestion is success."),x=i},error:function(){s("community PopularQuestion is error.")}})}function y(i,n){function t(i,a){var e='<div class="pdCommunitySideCol" id="js_pdCommunitySideCol"><div class="questionEntryBox"><div class="fs13">商品の気になることを購入者に質問しよう！</div><div class="yBtn yBtnMedium mt10"><span class="yBtnInner"><a href="<%= params.questionSubmitUrl %>" class="yBtnText">購入者に質問する</a></span></div></div><% if (data) { %><div class="comEmphasis"><a href="<%= params.questionListUrl %>">Q＆A</a><span class="num">（<%= data.totalCount %>）</span></div><div class="comWallBlock"><% _.each(data.questions, function(q) { %><div class="comListUnit"><div class="userImg"><a class="js_userImg" href="<%= q.userUrl %>"><img src="<%= q.communityUser.profileThumbnailImageUrl %>"></a></div><% if (q.topImageUrl) { %><div class="questionBox markerQ comLineInfo comRevieImg mLeft60 clearfix"><div class="cntrbtImg"><a href="<%= q.detailUrl %>"><img src="<%= q.topImageUrl %>"></a></div><% } else { %><div class="questionBox markerQ comLineInfo mLeft60 clearfix"><% } %><p class="cntrbtTxt"><%= q.questionBody %></p><div class="liMt10"><p><a href="<%= q.detailUrl %>" class="fs11">詳しく見る</a></p><div class="uiIconTxtS lineDate"><i class="iconLiS icon33S"></i><span class="mr05"><%= q.answerCount %></span><span class="fs11 gray"><%= q.postDate %></span></div><% if (q.followFlg === true) { %><div class="lineDate"><span class="uiIconTxtS fs11"><i class="iconLiS icon41S"></i><span>質問をフォロー中</span></span></div><% } %><div class="answerCredit"><a href="<%= q.userUrl %>"><%= q.communityUser.communityName %></a>さん</div></div></div><% if (q.answer) { %><% if (q.answer.topImageUrl) { %><div class="answerFrame markerA answerImg"><% } else { %><div class="answerFrame markerA"><% } %><div class="bllnCmtBoxY  clearfix"><div class="tale"></div><% if (q.answer.topImageUrl) { %><div class="cntrbtImg"><a href="<%= q.answer.detailUrl %>"><img src="<%= q.answer.topImageUrl %>"></a></div><% } %><p class="answerTxt"><%= q.answer.answerBody %></p><p><a href="<%= q.answer.detailUrl %>" class="fs11">詳しく見る</a></p><div class="liMt10"><div class="comLineSocial"><span class="uiIconTxtS"><i class="iconLiS icon15S"></i><span><%= q.answer.likeCount %></span></span><span class="uiIconTxtS"><i class="iconLiS icon14S"></i><span><%= q.answer.commentCount %></span></span><span class="fs11 gray"><%= q.answer.postDate %></span></div><div class="userInfo"><a href="<%= q.answer.userUrl %>"><img src="<%= q.answer.communityUser.profileThumbnailImageUrl %>"><span><%= q.answer.communityUser.communityName %></span></a>さん</div></div></div></div><% } %></div><% }) %></div><div class="fs13 mt30"><a href="<%= params.questionListUrl %>">すべてのQ＆Aを見る</a><span class="num">（<%= data.totalCount %>）</span></div><% } %></div>';var n=s.template(e);var t=n(a);i.append(t)}function r(s){return d.replace(/,QUESTIONID,/,s)}var o={};var c=n.questions;var l=c.length;var u,m;for(u=0;u<l;u++)m=c[u],m.answerCount=m.answerCount?m.answerCount:0,m.userUrl=a(m.communityUser.communityName),m.postDate=e(m.postDate),m.questionBody=m.questionBody?m.questionBody:"",m.detailUrl=r(m.questionId),m.answer&&(m.answer.answerBody=m.answer.answerBody?m.answer.answerBody:"",m.answer.commentCount=m.answer.commentCount?m.answer.commentCount:0,m.answer.likeCount=m.answer.likeCount?m.answer.likeCount:0,m.answer.postDate=e(m.answer.postDate),m.answer.detailUrl=r(m.questionId),m.answer.userUrl=a(m.answer.communityUser.communityName));o.questionListUrl=p,o.questionSubmitUrl=v,t(i,{data:n,params:o})}function h(s){if(I!==!1){I=!0,s.addClass("clearfix"),s.addClass("mb20");var a=i.find(".jsCommunityReviewSubmitBelow");var e=i.find(".jsCommunityReviewSubmit");e.attr("href",a.attr("href")),i.find(".jsCommunityReviewSubmitButton").show()}}function U(){S!==!1&&(S=!0,w())}function g(s){var i=[];i.push(new Promise(n)),i.push(new Promise(r)),Promise.all(i).then(function(){s()})}var I=!0;var S=!0;var C;var x;g(function(){if(C&&x){var s=i.find(".js_pdCommunityRenderArea");h(s),s.html(""),y(s,x),t(s,C),U()}})}function t(){function s(){var a=$(window).height();var e=$(document).scrollTop();var t=i.offset().top;e>t-a&&(n(i),$(window).unbind("scroll",s))}var i=$(r);$(window).bind("scroll",s)}var r="#productSet6Opened--userEvaluation";var o;var c;var l;var u;var m;var p;var v;var d;var f;var w;!function(){"use strict";function s(s,i,n){function t(s){var i=/.*\/community\/user\//;var a=/\/.*/;var e;if(s.match(i,"")&&(e=s.replace(i,""),e=e.match(a,"")?e.replace(a,""):void 0),e)return encodeURI(e)}function r(s,i,a){var e=a.communityUser.profileThumbnailImageUrl;var n=a.communityUser.communityName;var t='<div class="puBox" style="width: 350px; margin: 20px 10px;"><div class="puContainer pa10"><div class="comListUnit mgNone"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="imgTd pr10"><div class="userImg"><a href="'+i+'"><img src="'+e+'" /></a></div></td><td><div class="fs12"><a href="'+i+'">'+n+"</a>さん</div>";a.productMaster&&a.productMaster.rank&&(t+='<div class="fs12 mt05"><span class="uiIconTxtS"><i class="iconLiS icon09S"></i><span><strong></strong>TOP'+a.productMaster.rank+"商品マスター</span></span></div>"),a.purchaseProduct&&a.purchaseProduct.purchaseDateText&&(t+='<div class="fs12 mt10"><strong class="red">この商品を持っています。</strong>（<span>'+a.purchaseProduct.purchaseDateText+"</span>に購入）</div>"),t+='<div class="vrtList liMt05 fs11"><ul>',parseInt(a.postReviewCount)>0&&(t+='<li><span class="uiIconTxtS"><i class="iconLiS icon01S"></i><span>レビュー投稿数：'+a.postReviewCount+"</span></span></li>"),parseInt(a.postQuestionCount)>0&&(t+='<li><span class="uiIconTxtS"><i class="iconLiS icon02S"></i><span>Q＆A質問数：'+a.postQuestionCount+"</span></span></li>"),parseInt(a.postAnswerCount)>0&&(t+='<li><span class="uiIconTxtS"><i class="iconLiS icon33S"></i><span>Q＆A回答数：'+a.postAnswerCount+"</span></span></li>"),parseInt(a.postImageCount)>0&&(t+='<li><span class="uiIconTxtS"><i class="iconLiS icon12S"></i><span>画像投稿数：'+a.postImageCount+"</span></span></li>"),t+="</ul></div></td></tr></tbody></table></div></div></div>",s.html(t)}if(n){var o=$(s);var c=$(o.parent());var l=t(o.attr("href"));if(l){o.after('<div class="js_communityProfilePopup" style="position: absolute;"></div>');var u=$(c.find(".js_communityProfilePopup"));u.css("top",n.offsetTop),u.css("left",n.offsetLeft),u.html('<div style="width: 350px; margin: 20px 10px;" class="puBox"><div class="puContainer pa10"><div class="comListUnit mgNone">loading ....</div></div></div>'),u.hover(function(){$(this).show()},function(){$(this).hide()}),$.ajax({type:"GET",url:a()+"api/community/communityProfile?communityName="+l+"&sku="+e(),dataType:"json",success:function(s){r(u,i,s)}})}}}function i(i,a){var e=$(i).attr("href");var n=$($(i).parent());var t=$(n.find(".js_communityProfilePopup"));0===t.length&&s(i,e,a),t.show()}function n(s){var i=$($(s).parent());var a=$(i.find(".js_communityProfilePopup"));a.hide()}w=function(){$("#js_pdCommunitySideCol").find("div.userImg > a").hover(function(){i(this,{offsetTop:"50px",offsetLeft:"-100px"})},function(){n(this)}),$("#js_pdCommunitySideCol").find("div.userInfo > a").hover(function(){i(this,{offsetTop:"10px",offsetLeft:"-120px"})},function(){n(this)}),$("#js_pdCommunityMainCol").find("div.userImg > a").hover(function(){i(this,{offsetTop:"50px",offsetLeft:"0px"})},function(){n(this)})}}(),$(function(){i()!==!1&&t()})}(_);