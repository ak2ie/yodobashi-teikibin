!function(e){var s=function(e){function s(){var e="";return t(".js_editInputed").each(function(){var s=t(this).val();s=t.trim(s),""!==s&&(e+=s+" ")}),e}var t=e;return{removeBtag:function(e){return e?(e=e.replace(/<.*?>/g,""),e=e.replace(/<\/.*?>/g,"")):""},htmlUnescape:function(e){return e?(e=e.replace(/&amp;/g,"&"),e=e.replace(/&gt;/g,">"),e=e.replace(/&lt;/g,"<")):""},getLeftTextboxValues:function(){return s()},createRowString:function(e,t,r){function a(e){return e&&(e=e.replace(/\u00A0/g," "),e=e.replace(/\u3000/g," "),e=e.replace(/\\/g,""),e=e.replace(/[\(\)\[\]\*\+\?]/g,""),e=e.replace(/\s*$/,""),e=e.replace(/^\s*/,""),e=e.replace(/[\s]+/g," ")),e}var o;var n;var c;return o=new RegExp("("+a(t)+")(.*)","i"),"breadCrumb"===e&&(n=s(),""!==n&&(r=r.substring(n.length))),c=r.match(o)?r.replace(o,"<strong>$1</strong>$2"):"<strong>"+r+"</strong>"},createUrlString:function(e,r,a,o,n,c){var i=e;var g="";var l;var v=void 0;if(r&&(o&&(g="&category="+o),"breadCrumb"===a&&(i=s()+i),""!==i)){if(c===!0)l=2,v=2;else if("breadCrumb"!==a){var d=t(window).height()-150;n=Math.floor(d/28),l=Math.ceil(.23*n),v=l}else l=3;return r+"?cli=yodo2011&rows="+n+"&fl=suggest&wt=jsonp&callback=suggestFeed"+g+"&q="+encodeURIComponent(i)+"&cm_rows="+l+(void 0!==v?"&cd_rows="+v:"")}},transitionCategoryPage:function(e,s){t.ajax({url:wsUrl+"api/category/transition",dataType:"jsonp",data:{uniqueCategoryCode:e,isSmartPhone:s},success:function(e){e.url&&(window.location.href=e.url)}})}}};var t=function(e){function t(e){function s(){j.css("display","none"),n(".js_srchSgstRow",j).remove()}function t(e){var s;var t;var r;var a;var o;var i=n(_).val();var g=e.response.keyword.item;var l=e.response.categoryDirect;for(s=-1;s<g.length;s++)s===-1?j.append('<div class="sgstLink js_srchSgstRow" style="display:none;">'+i+"</div>"):(o="",g[s]._attributes&&(t=g[s]._attributes.code,r=g[s]._attributes.name,g[s]=g[s]._content,o='<span class="srcFltr js_cateCode-'+t+'">を<strong class="orange mrl05">'+r+"</strong>で検索</span>"),a="",""!==o&&"searchBox"!==k||(a=c.createRowString(k,i,g[s])),j.append('<div class="sgstLink js_srchSgstRow">'+a+o+"</div>"));if(l&&l.item){var v=e.response.categoryDirect.item;if(v.length)for(j.append('<hr class="js_sgstRowHr"/>'),s=0;s<v.length;s++){var d=v[s];var u="";if(d.path){var h=d.path;h=h.replace(/\$/g," &gt; "),u='<span class="sgsrSubKeyword js_breadcrumbs">'+h+" &gt; </span>"}j.append('<div class="sgstLink js_srchSgstRow js_cateSgstRow" data-uniquecategorycode="'+d.code+'" data-sgstword="'+d.name+'">'+u+'<strong class="orange">'+d.name+'</strong><span class="srcFltr">カテゴリ</span></div>');var p=n(".js_srchSgstRow:last");if(p.height()>19){var f=p.find(".js_breadcrumbs");for(;p.height()>19&&!(f.lneght<=0);){var m=f.html();if(null===m)break;var w=m.split(" &gt; ");if(null===w||w.length<=1)break;if(w.pop(),w.length<=1){var b=w[0].replace(/...$/,"");if(b.length<=0)break;b=b.substr(0,b.length-1),f.html(b+"... &gt; ")}else if(w.length<=2)"..."!==w[w.length-1]?(w[w.length-1]="...",f.html(w.join(" &gt; ")+" &gt; ")):(w.pop(),f.html(w[0]+" &gt; "));else if("..."!==w[w.length-2])w[w.length-2]="...",f.html(w.join(" &gt; ")+" &gt; ");else{var C=[];for(var R=0;R<w.length;R++)R!==w.length-2&&C.push(w[R]);f.html(C.join(" &gt; ")+" &gt; ")}}}}}}function g(){var e;var t;var r;var a;var o;var g;if(i.prevMode=k,w=!0,e=F.search(/js_cateCode-/i),e>=0&&(t=F.indexOf('"',e+12),r=e+12,a=F.substring(r,t),a&&(o=n("#js_selectBoxUniqCode"+a))))if(o.attr("selected",!0),"breadCrumb"===k)for(g=m-1;g>0&&(F=n(".js_srchSgstRow").eq(g).html(),!(F.search(/js_cateCode-/i)<0));g--);else t=F.search(/<span class="srcFltr/i),F=F.substring(0,t);s(),F=c.removeBtag(F),F=c.htmlUnescape(F),"breadCrumb"===k&&(n(_).val(F),F=c.getLeftTextboxValues()+F),n(q).val(F)}function l(e){var s;var t;var r;var a;var o;var i;if(m>=-1&&n(".js_srchSgstRow:eq("+m+")",j).removeClass("active"),m+1<=e&&m++,m+1>e&&(m=0),i=n(".js_srchSgstRow:eq("+m+")",j),i.hasClass("js_cateSgstRow"))F=i.data("sgstword"),F=c.removeBtag(F),F=c.htmlUnescape(F),n(_).val(F);else{if(F=i.html(),s=F.search(/js_cateCode-/i),s>=0)if(t=F.indexOf('"',s+12),r=s+12,a=F.substring(r,t),"breadCrumb"===k)for(o=m-1;o>0&&(F=n(".js_srchSgstRow").eq(o).html(),!(F.search(/js_cateCode-/i)<0));o--);else t=F.search(/<span class="srcFltr/i),F=F.substring(0,t);F=c.removeBtag(F),F=c.htmlUnescape(F),n(_).val(F)}i.addClass("active")}function v(e){var s;var t;var r;var a;var o;var i;if(m>=-1&&n(".js_srchSgstRow:eq("+m+")",j).removeClass("active"),m>=0&&m--,m<0&&(m=e-1),i=n(".js_srchSgstRow:eq("+m+")",j),i.hasClass("js_cateSgstRow"))F=i.data("sgstword"),F=c.removeBtag(F),F=c.htmlUnescape(F),n(_).val(F);else{if(F=i.html(),s=F.search(/js_cateCode-/i),s>=0)if(t=F.indexOf('"',s+12),r=s+12,a=F.substring(r,t),"breadCrumb"===k)for(o=m-1;o>0&&(F=n(".js_srchSgstRow").eq(o).html(),!(F.search(/js_cateCode-/i)<0));o--);else t=F.search(/<span class="srcFltr/i),F=F.substring(0,t);F=c.removeBtag(F),F=c.htmlUnescape(F),n(_).focus().val(F)}i.addClass("active")}function d(e){var s=n(_).val();var t=n(".js_cateSgstRow.active").data("sgstword");return s===t?(e.preventDefault(),void c.transitionCategoryPage(n(".js_cateSgstRow.active").data("uniquecategorycode"),!1)):(F=n(".js_srchSgstRow:eq("+m+")",j).html(),void(F&&g()))}function u(e){return e&&e.responseHeader&&e.responseHeader.message?("101"===e.responseHeader.message[0]?s():(m=0,n(".js_srchSgstRow",j).remove(),n(".js_sgstRowHr",j).remove(),j.css("display","block"),n.browser.msie&&8===parseInt(n.browser.version,10)?(n("#headerBtm").css("Filter","none"),t(e),n("#headerBtm").css("Filter","progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr='#EFEFEF', endColorstr='#E5E5E5')")):t(e)),0===n(".js_srchSgstRow",j).length&&s(),void h()):void s()}function h(){var e=!1;n(_).unbind("click"),n(_).click(function(){e=!0}),n("body").unbind("click"),n("body").click(function(){e?e=!1:s()}),n(".js_srchSgstRow",j).unbind("click"),n(".js_srchSgstRow",j).click(function(){return n(this).hasClass("js_cateSgstRow")?void c.transitionCategoryPage(n(this).data("uniquecategorycode"),!1):(m=n(".js_srchSgstRow",j).index(this),F=n(this).html(),g(),n(x).submit(),!1)}),n(".js_srchSgstRow",j).unbind("hover"),n(".js_srchSgstRow",j).hover(function(){m=n(".js_srchSgstRow",j).index(this),n(".js_srchSgstRow",j).each(function(){n(this).removeClass("active")}),n(".js_srchSgstRow:eq("+m+")",j).addClass("active")})}function p(e){var s;R&&(s=c.createUrlString(e,R,k,C,B,!1),s&&n.jsonp({url:s,callback:"suggestFeed",success:u,timeout:1e3}))}function f(e){var s=e.top;var t=40;var c;var i;var g="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0;w=!1,b=n("#"+e.suggestContainerId),j=n("#"+e.inputBoxId+"3145"),_="#"+e.inputBoxId,C=e.categoryCd,R=e.restUrl,S="#"+e.cateSelectId,x="#"+e.formId,k=e.mode,q=_,y&&clearTimeout(y),y=void 0,e.inputBoxId4Submit&&(q="#"+e.inputBoxId4Submit),e.suggestAdjustmentWidth&&(t=e.suggestAdjustmentWidth),e.suggestRows&&(B=e.suggestRows),F=n(_).val(),n(_).attr("autocomplete","off"),j.css("top",s+"px"),j.css("display","none"),j.css("position","absolute"),j.css("z-index","10000"),c=n(_).width()+10,setTimeout(function(){c=n(_).width()+t,j.css("width",c+"px")},500),n(window).resize(function(){c=n(_).width()+t,j.css("width",c+"px")}),n(S).change(function(){var e=n(S+" option:selected").attr("data-selectboxcatecode");C=e?e:""}).change(),i=document.URL,i.match(/#/)||g||n(_).focus(),b.bind("keydown",function(e){var s=n(".js_srchSgstRow",j).length;s>0?e.keyCode===r?l(s):e.keyCode===a?v(s):e.keyCode===o&&d(e):e.keyCode===o?d(e):e.keyCode===r&&p(n(_).val())}),n("#searchForm").bind("submit",function(){return!1})}var m;var w=!1;var b;var j;var _;var C;var R;var S;var y;var x;var k;var q;var B=13;var F;var U=function(){var e=n(_).val();F!==e&&(e?void 0!==i.prevMode&&i.prevMode!==k||w!==!1||p(e):"breadCrumb"===k?p(e):s(),F=e),y=setTimeout(U,300)};f(e),U()}var r=40;var a=38;var o=13;var n=e;var c=s(n);var i={prevMode:void 0};return{create:function(e){return new t(e)},proc:function(e){t(e)}}};var r=t(e);e.sgst=function(e){r.proc(e)}}(jQuery);